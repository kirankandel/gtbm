---
import { languages } from '../i18n/ui';
import { getLangFromUrl } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const currentUrl = Astro.url.pathname;
const isNepali = lang === 'ne';

function getLocalizedPath(language: string) {
  const segments = currentUrl.split('/').filter(Boolean);
  
  if (segments.length > 0 && segments[0] in languages) {
    segments[0] = language;
  } else {
    segments.unshift(language);
  }
  
  return `/${segments.join('/')}`;
}
---

<div class="flex items-center gap-1 bg-white/10 px-2.5 py-1.5 rounded-[20px] text-[0.85rem] font-semibold dark:bg-white/5">
  <a href={getLocalizedPath('en')} class:list={["text-white/60 px-1.5 py-[0.2rem] rounded transition-all duration-200 hover:text-white decoration-none dark:text-white/50", { "!text-white bg-white/20 dark:bg-white/15": !isNepali }]}>EN</a>
  <span class="text-white/30">|</span>
  <a href={getLocalizedPath('ne')} class:list={["text-white/60 px-1.5 py-[0.2rem] rounded transition-all duration-200 hover:text-white decoration-none dark:text-white/50", { "!text-white bg-white/20 dark:bg-white/15": isNepali }]}>рдиреЗ</a>
</div>
